<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sadhana Yoga Retreat</title>
    <style>
        :root {
            --dark-green: #506C4A;
            --light-green: #8DA399;
            --gold: #C9A96E;
            --text-color: #192812;
            --background: #F4F1EC;
            --light-accent: #E8E4D9;
            --white: #FFFFFF;
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(80, 108, 74, 0.08);
            --transition: all 0.3s ease;
            --link-blue: #1a73e8;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background);
            color: var(--text-color);
            line-height: 1.6;
            padding: 15px;
            max-width: 1200px;
            margin: 0 auto;
        }

        h1,
        h2,
        h3,
        h4 {
            color: var(--dark-green);
            margin-bottom: 1rem;
        }

        h2 {
            border-bottom: 1px solid var(--light-accent);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .section {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hidden {
            display: none;
        }

        label {
            font-weight: 600;
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            color: var(--dark-green);
        }

        input,
        select,
        textarea {
            padding: 12px;
            width: 100%;
            margin-top: 4px;
            border: 1px solid var(--light-accent);
            border-radius: var(--border-radius);
            background-color: var(--white);
            font-size: 16px;
            transition: var(--transition);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--dark-green);
            box-shadow: 0 0 0 2px rgba(80, 108, 74, 0.2);
        }

        button {
            padding: 12px 24px;
            margin-top: 15px;
            cursor: pointer;
            background-color: var(--dark-green);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 16px;
            transition: var(--transition);
            box-shadow: 0 2px 4px rgba(80, 108, 74, 0.2);
        }

        button:hover {
            background-color: #3e553c;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(80, 108, 74, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        #adminBtn,
        #backToClient {
            background-color: transparent;
            color: var(--dark-green);
            border: 2px solid var(--dark-green);
        }

        #adminBtn:hover,
        #backToClient:hover {
            background-color: rgba(80, 108, 74, 0.1);
        }

        .table-wrap {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-width: 700px;
            /* allow horizontal scroll on small screens */
        }

        th,
        td {
            border: 1px solid var(--light-accent);
            padding: 12px;
            text-align: center;
            vertical-align: middle;
        }

        th {
            background-color: var(--dark-green);
            color: white;
            font-weight: 600;
            cursor: pointer;
            position: sticky;
            top: 0;
            z-index: 3;
        }

        tr:nth-child(even) {
            background-color: rgba(244, 241, 236, 0.5);
        }

        tr:hover {
            background-color: rgba(80, 108, 74, 0.05);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--dark-green) 0%, #3e553c 100%);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .header h1 {
            color: white;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .retreat-card {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .retreat-info {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            background-color: rgba(80, 108, 74, 0.05);
            border-radius: var(--border-radius);
        }

        .booking-form {
            flex: 1;
            min-width: 300px;
        }

        .price-display {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--dark-green);
            text-align: center;
            margin: 10px 0;
            padding: 10px;
            background-color: rgba(80, 108, 74, 0.1);
            border-radius: var(--border-radius);
        }

        .departure-note {
            font-style: italic;
            color: var(--dark-green);
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .search-container {
            margin: 15px 0;
            display: flex;
            gap: 10px;
        }

        .search-container input {
            margin-top: 0;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            text-align: center;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(80, 108, 74, 0.15);
        }

        .dashboard-card h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--dark-green);
        }

        .dashboard-card .number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--dark-green);
        }

        .card-arriving {
            border-top: 4px solid var(--light-green);
        }

        .card-departing {
            border-top: 4px solid var(--gold);
        }

        .card-weekly {
            border-top: 4px solid #8DA399;
        }

        .card-monthly {
            border-top: 4px solid #506C4A;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* Confirmation slip styles removed since generated dynamically */

        .status-message {
            padding: 10px;
            margin: 10px 0;
            border-radius: var(--border-radius);
            text-align: center;
        }

        .status-success {
            background-color: rgba(80, 108, 74, 0.1);
            color: var(--dark-green);
            border: 1px solid var(--dark-green);
        }

        .status-error {
            background-color: rgba(255, 0, 0, 0.1);
            color: #d32f2f;
            border: 1px solid #d32f2f;
        }

        /* WhatsApp link style */
        .whatsapp-link {
            color: var(--link-blue);
            text-decoration: underline;
            font-weight: 600;
            display: inline-block;
        }

        /* Phone input container */
        .phone-container {
            display: flex;
            gap: 10px;
        }

        .country-code {
            width: 120px;
        }

        .phone-number {
            flex: 1;
        }

        /* Make tables touch friendly on mobile */
        td a.whatsapp-link {
            padding: 6px 4px;
            border-radius: 6px;
        }

        /* Mobile adjustments */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .section {
                padding: 15px;
            }

            .retreat-card {
                flex-direction: column;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header p {
                font-size: 1rem;
            }

            .price-display {
                font-size: 1.5rem;
            }

            table {
                font-size: 0.95rem;
                min-width: 600px;
            }

            th,
            td {
                padding: 10px 8px;
            }

            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }

            .admin-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .phone-container {
                flex-direction: column;
                gap: 8px;
            }

            .country-code {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.9rem;
            }

            button {
                width: 100%;
                margin-top: 10px;
            }

            .search-container {
                flex-direction: column;
            }

            .dashboard-cards {
                grid-template-columns: 1fr;
            }

            .admin-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            table {
                min-width: 520px;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>Sadhana Yoga Retreat</h1>
        <p>Find peace, balance, and renewal in the heart of nature</p>
    </div>

    <!-- CLIENT INTERFACE -->
    <div id="clientInterface" class="section">
        <h2>Book Your Yoga Retreat</h2>

        <div class="retreat-card">
            <div class="retreat-info">
                <h3>Important Information</h3>
                <p>Arrival is on 3 PM. This will be on Sadhana's booking calendar, so confirm first before filling the
                    information.</p>
                <ul style="margin-top: 15px; padding-left: 20px;">
                    <li>Check-in: 3 PM on arrival day</li>
                    <li>Check-out: 11 AM after breakfast on departure day</li>
                    <li>All bookings are subject to availability</li>
                    <li>Please arrive 15 minutes early for orientation</li>
                </ul>
            </div>

            <div class="booking-form">
                <form id="bookingForm">
                    <label>Guest Name</label>
                    <input type="text" name="guest_name" required placeholder="Enter your full name">

                    <label>Country</label>
                    <input type="text" name="country" required placeholder="Your country of residence">

                    <label>Email</label>
                    <input type="email" name="email" required placeholder="Your email address">

                    <label>WhatsApp / Phone</label>
                    <div class="phone-container">
                        <select class="country-code" id="countryCode" required>
                            <option value="" disabled selected>Code</option>
                            <option value="93">+93 (Afghanistan)</option>
                            <option value="355">+355 (Albania)</option>
                            <option value="213">+213 (Algeria)</option>
                            <option value="376">+376 (Andorra)</option>
                            <option value="244">+244 (Angola)</option>
                            <option value="1">+1 (Antigua and Barbuda)</option>
                            <option value="54">+54 (Argentina)</option>
                            <option value="374">+374 (Armenia)</option>
                            <option value="297">+297 (Aruba)</option>
                            <option value="61">+61 (Australia)</option>
                            <option value="43">+43 (Austria)</option>
                            <option value="994">+994 (Azerbaijan)</option>
                            <option value="1">+1 (Bahamas)</option>
                            <option value="973">+973 (Bahrain)</option>
                            <option value="880">+880 (Bangladesh)</option>
                            <option value="1">+1 (Barbados)</option>
                            <option value="375">+375 (Belarus)</option>
                            <option value="32">+32 (Belgium)</option>
                            <option value="501">+501 (Belize)</option>
                            <option value="229">+229 (Benin)</option>
                            <option value="975">+975 (Bhutan)</option>
                            <option value="591">+591 (Bolivia)</option>
                            <option value="387">+387 (Bosnia and Herzegovina)</option>
                            <option value="267">+267 (Botswana)</option>
                            <option value="55">+55 (Brazil)</option>
                            <option value="673">+673 (Brunei)</option>
                            <option value="359">+359 (Bulgaria)</option>
                            <option value="226">+226 (Burkina Faso)</option>
                            <option value="257">+257 (Burundi)</option>
                            <option value="855">+855 (Cambodia)</option>
                            <option value="237">+237 (Cameroon)</option>
                            <option value="1">+1 (Canada)</option>
                            <option value="238">+238 (Cape Verde)</option>
                            <option value="236">+236 (Central African Republic)</option>
                            <option value="235">+235 (Chad)</option>
                            <option value="56">+56 (Chile)</option>
                            <option value="86">+86 (China)</option>
                            <option value="57">+57 (Colombia)</option>
                            <option value="269">+269 (Comoros)</option>
                            <option value="242">+242 (Congo)</option>
                            <option value="682">+682 (Cook Islands)</option>
                            <option value="506">+506 (Costa Rica)</option>
                            <option value="385">+385 (Croatia)</option>
                            <option value="53">+53 (Cuba)</option>
                            <option value="357">+357 (Cyprus)</option>
                            <option value="420">+420 (Czech Republic)</option>
                            <option value="243">+243 (Democratic Republic of the Congo)</option>
                            <option value="45">+45 (Denmark)</option>
                            <option value="253">+253 (Djibouti)</option>
                            <option value="1">+1 (Dominica)</option>
                            <option value="1">+1 (Dominican Republic)</option>
                            <option value="593">+593 (Ecuador)</option>
                            <option value="20">+20 (Egypt)</option>
                            <option value="503">+503 (El Salvador)</option>
                            <option value="240">+240 (Equatorial Guinea)</option>
                            <option value="291">+291 (Eritrea)</option>
                            <option value="372">+372 (Estonia)</option>
                            <option value="251">+251 (Ethiopia)</option>
                            <option value="679">+679 (Fiji)</option>
                            <option value="358">+358 (Finland)</option>
                            <option value="33">+33 (France)</option>
                            <option value="241">+241 (Gabon)</option>
                            <option value="220">+220 (Gambia)</option>
                            <option value="995">+995 (Georgia)</option>
                            <option value="49">+49 (Germany)</option>
                            <option value="233">+233 (Ghana)</option>
                            <option value="30">+30 (Greece)</option>
                            <option value="1">+1 (Grenada)</option>
                            <option value="502">+502 (Guatemala)</option>
                            <option value="224">+224 (Guinea)</option>
                            <option value="245">+245 (Guinea-Bissau)</option>
                            <option value="592">+592 (Guyana)</option>
                            <option value="509">+509 (Haiti)</option>
                            <option value="504">+504 (Honduras)</option>
                            <option value="36">+36 (Hungary)</option>
                            <option value="354">+354 (Iceland)</option>
                            <option value="91">+91 (India)</option>
                            <option value="62">+62 (Indonesia)</option>
                            <option value="98">+98 (Iran)</option>
                            <option value="964">+964 (Iraq)</option>
                            <option value="353">+353 (Ireland)</option>
                            <option value="972">+972 (Israel)</option>
                            <option value="39">+39 (Italy)</option>
                            <option value="1">+1 (Jamaica)</option>
                            <option value="81">+81 (Japan)</option>
                            <option value="962">+962 (Jordan)</option>
                            <option value="7">+7 (Kazakhstan)</option>
                            <option value="254">+254 (Kenya)</option>
                            <option value="686">+686 (Kiribati)</option>
                            <option value="850">+850 (North Korea)</option>
                            <option value="82">+82 (South Korea)</option>
                            <option value="965">+965 (Kuwait)</option>
                            <option value="996">+996 (Kyrgyzstan)</option>
                            <option value="856">+856 (Laos)</option>
                            <option value="371">+371 (Latvia)</option>
                            <option value="961">+961 (Lebanon)</option>
                            <option value="266">+266 (Lesotho)</option>
                            <option value="231">+231 (Liberia)</option>
                            <option value="218">+218 (Libya)</option>
                            <option value="423">+423 (Liechtenstein)</option>
                            <option value="370">+370 (Lithuania)</option>
                            <option value="352">+352 (Luxembourg)</option>
                            <option value="853">+853 (Macau)</option>
                            <option value="389">+389 (North Macedonia)</option>
                            <option value="261">+261 (Madagascar)</option>
                            <option value="265">+265 (Malawi)</option>
                            <option value="60">+60 (Malaysia)</option>
                            <option value="960">+960 (Maldives)</option>
                            <option value="223">+223 (Mali)</option>
                            <option value="356">+356 (Malta)</option>
                            <option value="692">+692 (Marshall Islands)</option>
                            <option value="222">+222 (Mauritania)</option>
                            <option value="230">+230 (Mauritius)</option>
                            <option value="52">+52 (Mexico)</option>
                            <option value="691">+691 (Micronesia)</option>
                            <option value="373">+373 (Moldova)</option>
                            <option value="377">+377 (Monaco)</option>
                            <option value="976">+976 (Mongolia)</option>
                            <option value="382">+382 (Montenegro)</option>
                            <option value="212">+212 (Morocco)</option>
                            <option value="258">+258 (Mozambique)</option>
                            <option value="95">+95 (Myanmar)</option>
                            <option value="264">+264 (Namibia)</option>
                            <option value="674">+674 (Nauru)</option>
                            <option value="977">+977 (Nepal)</option>
                            <option value="31">+31 (Netherlands)</option>
                            <option value="64">+64 (New Zealand)</option>
                            <option value="505">+505 (Nicaragua)</option>
                            <option value="227">+227 (Niger)</option>
                            <option value="234">+234 (Nigeria)</option>
                            <option value="47">+47 (Norway)</option>
                            <option value="968">+968 (Oman)</option>
                            <option value="92">+92 (Pakistan)</option>
                            <option value="680">+680 (Palau)</option>
                            <option value="970">+970 (Palestine)</option>
                            <option value="507">+507 (Panama)</option>
                            <option value="675">+675 (Papua New Guinea)</option>
                            <option value="595">+595 (Paraguay)</option>
                            <option value="51">+51 (Peru)</option>
                            <option value="63">+63 (Philippines)</option>
                            <option value="48">+48 (Poland)</option>
                            <option value="351">+351 (Portugal)</option>
                            <option value="974">+974 (Qatar)</option>
                            <option value="40">+40 (Romania)</option>
                            <option value="7">+7 (Russia)</option>
                            <option value="250">+250 (Rwanda)</option>
                            <option value="685">+685 (Samoa)</option>
                            <option value="378">+378 (San Marino)</option>
                            <option value="239">+239 (Sao Tome and Principe)</option>
                            <option value="966">+966 (Saudi Arabia)</option>
                            <option value="221">+221 (Senegal)</option>
                            <option value="381">+381 (Serbia)</option>
                            <option value="248">+248 (Seychelles)</option>
                            <option value="232">+232 (Sierra Leone)</option>
                            <option value="65">+65 (Singapore)</option>
                            <option value="421">+421 (Slovakia)</option>
                            <option value="386">+386 (Slovenia)</option>
                            <option value="677">+677 (Solomon Islands)</option>
                            <option value="252">+252 (Somalia)</option>
                            <option value="27">+27 (South Africa)</option>
                            <option value="211">+211 (South Sudan)</option>
                            <option value="34">+34 (Spain)</option>
                            <option value="94">+94 (Sri Lanka)</option>
                            <option value="249">+249 (Sudan)</option>
                            <option value="597">+597 (Suriname)</option>
                            <option value="46">+46 (Sweden)</option>
                            <option value="41">+41 (Switzerland)</option>
                            <option value="963">+963 (Syria)</option>
                            <option value="886">+886 (Taiwan)</option>
                            <option value="992">+992 (Tajikistan)</option>
                            <option value="255">+255 (Tanzania)</option>
                            <option value="66">+66 (Thailand)</option>
                            <option value="228">+228 (Togo)</option>
                            <option value="676">+676 (Tonga)</option>
                            <option value="1">+1 (Trinidad and Tobago)</option>
                            <option value="216">+216 (Tunisia)</option>
                            <option value="90">+90 (Turkey)</option>
                            <option value="993">+993 (Turkmenistan)</option>
                            <option value="688">+688 (Tuvalu)</option>
                            <option value="256">+256 (Uganda)</option>
                            <option value="380">+380 (Ukraine)</option>
                            <option value="971">+971 (United Arab Emirates)</option>
                            <option value="44">+44 (United Kingdom)</option>
                            <option value="1">+1 (United States)</option>
                            <option value="598">+598 (Uruguay)</option>
                            <option value="998">+998 (Uzbekistan)</option>
                            <option value="678">+678 (Vanuatu)</option>
                            <option value="379">+379 (Vatican City)</option>
                            <option value="58">+58 (Venezuela)</option>
                            <option value="84">+84 (Vietnam)</option>
                            <option value="967">+967 (Yemen)</option>
                            <option value="260">+260 (Zambia)</option>
                            <option value="263">+263 (Zimbabwe)</option>

                        </select>
                        <input type="text" class="phone-number" id="phoneNumber" required placeholder="Phone number">
                    </div>
                    <input type="hidden" id="phone" name="phone">

                    <label>Retreat Package</label>
                    <select id="retreatPackage" name="package" required>
                        <option value="" disabled selected>Select Package</option>
                        <option value="Silent Yoga Retreat 6D/6N">Silent Yoga Retreat 6D/6N</option>
                        <option value="Yoga and Ayurvedic Massage 2D/2N">Yoga and Ayurvedic Massage 2D/2N</option>
                        <option value="Introductory Hatha Yoga 4D/4N">Introductory Hatha Yoga 4D/4N</option>
                        <option value="Yogic Cleansing and Stretching 2D/2N">Yogic Cleansing and Stretching 2D/2N
                        </option>
                        <option value="One-Day Yoga and Meditation 1DAY">One-Day Yoga and Meditation 1DAY</option>
                        <option value="Fasting and Gastro-Cleansing 7D/7N">Fasting and Gastro-Cleansing 7D/7N</option>
                        <option value="Yoga and Juice Fasting 4D/4N">Yoga and Juice Fasting 4D/4N</option>
                        <option value="Silent Detox Retreat in Nepal 6D/6N">Silent Detox Retreat in Nepal 6D/6N</option>
                        <option value="Standard Hatha Yoga 7D/7N">Standard Hatha Yoga 7D/7N</option>
                    </select>

                    <label>Room Type</label>
                    <select id="roomType" name="room_type" required>
                        <option value="" disabled selected>Select Room Type</option>
                    </select>

                    <label>Price</label>
                    <div class="price-display" id="priceDisplay">$0</div>
                    <input type="hidden" id="price" name="price">

                    <label>Arrival Date</label>
                    <input type="date" name="arrival_date" required>

                    <label>Departure Date</label>
                    <input type="date" name="departure_date" readonly>
                    <div class="departure-note">Check-out at 11 AM after breakfast</div>

                    <label>Remarks</label>
                    <textarea name="remarks" rows="3"
                        placeholder="Any special requests or dietary requirements"></textarea>

                    <button type="submit">Submit Booking</button>
                </form>
            </div>
        </div>

        <button id="adminBtn">ADMIN ACCESS</button>
    </div>

    <!-- ADMIN LOGIN -->
    <div id="adminLogin" class="section hidden">
        <h2>Admin Login</h2>
        <label>Enter PIN</label>
        <input type="password" id="adminPin" placeholder="Enter admin PIN">
        <button id="loginAdmin">Login</button>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="section hidden">
        <div class="admin-header">
            <h2>Admin Dashboard</h2>
            <button id="backToClient">Back to Client View</button>
        </div>

        <!-- Dashboard Cards -->
        <div class="dashboard-cards">
            <div class="dashboard-card card-arriving">
                <h3>Arriving Today</h3>
                <div class="number" id="arrivingToday">0</div>
            </div>
            <div class="dashboard-card card-departing">
                <h3>Departing Today</h3>
                <div class="number" id="departingToday">0</div>
            </div>
            <div class="dashboard-card card-weekly">
                <h3>Total Bookings This Week</h3>
                <div class="number" id="weeklyBookings">0</div>
            </div>
            <div class="dashboard-card card-monthly">
                <h3>Monthly Estimate</h3>
                <div class="number" id="monthlyEstimate">$0</div>
            </div>
        </div>

        <!-- Arriving Today Table -->
        <h3>Arriving Today - Client Details</h3>
        <div class="table-wrap">
            <table id="arrivingTodayTable">
                <thead>
                    <tr>
                        <th data-sort="guest_name">Guest Name</th>
                        <th data-sort="package">Package</th>
                        <th data-sort="whatsapp">WhatsApp</th>
                        <th data-sort="arrival_date">Arrival Date</th>
                        <th data-sort="departure_date">Departure Date</th>
                        <th data-sort="price">Price</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <h3>Upcoming Bookings</h3>
        <div class="search-container">
            <input type="text" id="upcomingSearch" placeholder="Search upcoming bookings..." />
            <button id="clearUpcomingSearch">Clear</button>
        </div>
        <div class="table-wrap">
            <table id="upcomingTable">
                <thead>
                    <tr>
                        <th data-sort="guest_name">Guest Name</th>
                        <th data-sort="package">Package</th>
                        <th data-sort="whatsapp">WhatsApp</th>
                        <th data-sort="arrival_date">Arrival Date</th>
                        <th data-sort="departure_date">Departure Date</th>
                        <th data-sort="price">Price</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <h3>All Bookings</h3>
        <div class="search-container">
            <input type="text" id="allBookingsSearch" placeholder="Search all bookings..." />
            <button id="clearAllSearch">Clear</button>
        </div>
        <div class="table-wrap">
            <table id="allBookingsTable">
                <thead>
                    <tr>
                        <th data-sort="guest_name">Guest Name</th>
                        <th data-sort="package">Package</th>
                        <th data-sort="whatsapp">WhatsApp</th>
                        <th data-sort="arrival_date">Arrival Date</th>
                        <th data-sort="departure_date">Departure Date</th>
                        <th data-sort="price">Price</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <!-- Include html2canvas library -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>
        // Configuration
        const scriptURL = "https://script.google.com/macros/s/AKfycbycehH5GfUKtJbB1wmGSCb8Wmx8Z6unUM_OaeKSUh67bH_6obgZgZEF3fkmuIjViy_G/exec";

        const pricing = {
            "Silent Yoga Retreat 6D/6N": { "Private": 479 },
            "Yoga and Ayurvedic Massage 2D/2N": { "Private": 179, "Double": 149, "Dormitory": 119 },
            "Introductory Hatha Yoga 4D/4N": { "Private": 319, "Double": 259, "Dormitory": 199 },
            "Yogic Cleansing and Stretching 2D/2N": { "Private": 159, "Double": 129, "Dormitory": 99 },
            "One-Day Yoga and Meditation 1DAY": { "Dormitory": 79 },
            "Fasting and Gastro-Cleansing 7D/7N": { "Private": 559, "Double": 455, "Dormitory": 349 },
            "Yoga and Juice Fasting 4D/4N": { "Private": 319, "Double": 259, "Dormitory": 199 },
            "Silent Detox Retreat in Nepal 6D/6N": { "Private": 479, "Double": 389 },
            "Standard Hatha Yoga 7D/7N": { "Private": 559, "Double": 455, "Dormitory": 349 }
        };

        const retreatDuration = {
            "Silent Yoga Retreat 6D/6N": 6,
            "Yoga and Ayurvedic Massage 2D/2N": 2,
            "Introductory Hatha Yoga 4D/4N": 4,
            "Yogic Cleansing and Stretching 2D/2N": 2,
            "One-Day Yoga and Meditation 1DAY": 1,
            "Fasting and Gastro-Cleansing 7D/7N": 7,
            "Yoga and Juice Fasting 4D/4N": 4,
            "Silent Detox Retreat in Nepal 6D/6N": 6,
            "Standard Hatha Yoga 7D/7N": 7
        };

        // DOM elements
        const retreatSelect = document.getElementById("retreatPackage");
        const roomSelect = document.getElementById("roomType");
        const priceInput = document.getElementById("price");
        const priceDisplay = document.getElementById("priceDisplay");
        const arrivalInput = document.querySelector('input[name="arrival_date"]');
        const departureInput = document.querySelector('input[name="departure_date"]');
        const countryCodeSelect = document.getElementById("countryCode");
        const phoneNumberInput = document.getElementById("phoneNumber");
        const phoneHiddenInput = document.getElementById("phone");

        // Initialize form functionality
        function initForm() {
            retreatSelect.addEventListener("change", () => {
                updateRoomTypes();
                updateDepartureDate();
            });

            roomSelect.addEventListener("change", updatePrice);
            arrivalInput.addEventListener("change", updateDepartureDate);

            // Update phone hidden field when country code or phone number changes
            countryCodeSelect.addEventListener("change", updatePhoneField);
            phoneNumberInput.addEventListener("input", updatePhoneField);
        }

        function updatePhoneField() {
            const countryCode = countryCodeSelect.value;
            const phoneNumber = phoneNumberInput.value.replace(/\D/g, ''); // Remove non-digit characters

            if (countryCode && phoneNumber) {
                phoneHiddenInput.value = `https://wa.me/${countryCode}${phoneNumber}`;
            } else {
                phoneHiddenInput.value = '';
            }
        }

        function updateRoomTypes() {
            const retreat = retreatSelect.value;
            roomSelect.innerHTML = "<option value='' disabled selected>Select Room Type</option>";

            if (pricing[retreat]) {
                Object.keys(pricing[retreat]).forEach(rt => {
                    const opt = document.createElement("option");
                    opt.value = rt;
                    opt.textContent = rt;
                    roomSelect.appendChild(opt);
                });
            }

            priceInput.value = "";
            priceDisplay.textContent = "$0";
        }

        function updatePrice() {
            const retreat = retreatSelect.value;
            const room = roomSelect.value;

            if (pricing[retreat] && pricing[retreat][room]) {
                const price = pricing[retreat][room];
                priceInput.value = "$" + price;
                priceDisplay.textContent = "$" + price;
            } else {
                priceInput.value = "";
                priceDisplay.textContent = "$0";
            }
        }

        function updateDepartureDate() {
            const retreat = retreatSelect.value;
            const nights = retreatDuration[retreat];

            if (arrivalInput.value && nights) {
                const arrival = new Date(arrivalInput.value);
                const departure = new Date(arrival);
                // Add nights + 1 day for departure
                departure.setDate(arrival.getDate() + nights);
                departureInput.value = departure.toISOString().split('T')[0];
            }
        }

        // Helper to format dates
        function formatDate(dateStr) {
            const d = new Date(dateStr);
            if (isNaN(d.getTime())) return "";
            const day = d.getDate();
            const daySuffix = day % 10 === 1 && day !== 11 ? "st" :
                day % 10 === 2 && day !== 12 ? "nd" :
                    day % 10 === 3 && day !== 13 ? "rd" : "th";
            return `${day}${daySuffix} ${d.toLocaleString('en-US', { month: 'long' })} ${d.getFullYear()}`;
        }

        // Admin login functionality
        function initAdminLogin() {
            document.getElementById("adminBtn").addEventListener("click", () => {
                document.getElementById("clientInterface").classList.add("hidden");
                document.getElementById("adminLogin").classList.remove("hidden");
            });

            document.getElementById("loginAdmin").addEventListener("click", () => {
                const pin = document.getElementById("adminPin").value;
                if (pin === "19981998") {
                    document.getElementById("adminLogin").classList.add("hidden");
                    document.getElementById("adminPanel").classList.remove("hidden");
                    loadAdminData();
                } else {
                    alert("Nice TRY lil bro , only the real ones can access this ");
                }
            });

            // Back to client view
            document.getElementById("backToClient").addEventListener("click", () => {
                document.getElementById("adminPanel").classList.add("hidden");
                document.getElementById("clientInterface").classList.remove("hidden");
            });
        }

        // Create a styled confirmation slip for download (4:3 aspect ratio, readable)
        function createStyledConfirmation(data) {
            const width = 1200; // 4:3 => 1200x900 (keeps good resolution)
            const height = Math.round(width * 3 / 4);

            const confirmationDiv = document.createElement('div');
            confirmationDiv.style.cssText = `
                width: ${width}px;
                height: ${height}px;
                padding: 40px;
                background: linear-gradient(135deg, #f9f7f2 0%, #ffffff 100%);
                border: 4px solid #506C4A;
                border-radius: 20px;
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                color: #192812;
                position: relative;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            `;

            // Larger, readable typography and clear sections
            confirmationDiv.innerHTML = `
                <div style="text-align:center;">
                    <h1 style="font-size: 42px; margin: 0 0 6px 0; color: #506C4A;">Sadhana Yoga Retreat</h1>
                    <h2 style="font-size: 22px; margin: 0 0 12px 0; color: #8DA399;">Booking Confirmation</h2>
                    <p style="font-size: 16px; margin: 0; color: #666;">Find peace, balance, and renewal in the heart of nature</p>
                </div>

                <div style="display:flex; gap:18px; margin-top:20px;">
                    <div style="flex:1;">
                        <div style="padding:12px 16px; border-radius:10px; background:rgba(80,108,74,0.04); border-left:4px solid #506C4A;">
                            <div style="font-size:14px; color:#506C4A; font-weight:700;">Guest</div>
                            <div style="font-size:18px; margin-top:8px; font-weight:600;">${data.guest_name}</div>
                            <div style="font-size:14px; margin-top:6px;">${data.country}</div>
                            <div style="font-size:14px; margin-top:6px;">${data.email || ''}</div>
                        </div>
                    </div>

                    <div style="flex:1;">
                        <div style="padding:12px 16px; border-radius:10px; background:rgba(80,108,74,0.04); border-left:4px solid #506C4A;">
                            <div style="font-size:14px; color:#506C4A; font-weight:700;">Booking</div>
                            <div style="font-size:18px; margin-top:8px; font-weight:600;">${data.package}</div>
                            <div style="font-size:14px; margin-top:6px;">Room: ${data.room_type}</div>
                            <div style="font-size:14px; margin-top:6px;">Code: <strong>${data.booking_code}</strong></div>
                        </div>
                    </div>
                </div>

                <div style="display:flex; gap:18px; margin-top:20px;">
                    <div style="flex:1; padding:12px 16px; border-radius:10px; background:rgba(201,169,110,0.08); border:2px solid #C9A96E; text-align:center;">
                        <div style="font-size:14px; color:#666;">Arrival</div>
                        <div style="font-size:20px; font-weight:700; color:#506C4A; margin-top:6px;">${formatDate(data.arrival_date)} at 3 PM</div>
                    </div>
                    <div style="flex:1; padding:12px 16px; border-radius:10px; background:rgba(201,169,110,0.08); border:2px solid #C9A96E; text-align:center;">
                        <div style="font-size:14px; color:#666;">Departure</div>
                        <div style="font-size:20px; font-weight:700; color:#506C4A; margin-top:6px;">${formatDate(data.departure_date)} at 11 AM</div>
                    </div>
                </div>

                <div style="margin-top:20px; display:flex; gap:18px; align-items:center;">
                    <div style="flex:1;">
                        <div style="font-size:14px; color:#666; margin-bottom:8px;">Remarks</div>
                        <div style="padding:12px; background:rgba(80,108,74,0.04); border-radius:10px; min-height:54px;">${data.remarks || 'No special requests'}</div>
                    </div>
                    <div style="width:320px; text-align:center;">
                        <div style="font-size:14px; color:#666;">Total Amount</div>
                        <div style="font-size:36px; font-weight:800; color:#506C4A; margin-top:6px;">${data.price}</div>
                    </div>
                </div>

                <div style="margin-top:20px; font-size:14px; color:#666;">
                    <p style="margin:6px 0;">Thank you for choosing Sadhana Yoga Retreat. We look forward to welcoming you!</p>
                    <p style="margin:6px 0; font-weight:700; color:#c04a4a;">Please show this slip at the reception. Without the booking code you may face uncertainty in your room types and services.</p>
                </div>
            `;

            return confirmationDiv;
        }

        // Download confirmation as JPEG (keeps existing function name)
        function downloadConfirmationAsImage(data) {
            const confirmationDiv = createStyledConfirmation(data);

            // Append to body temporarily
            confirmationDiv.style.position = 'fixed';
            confirmationDiv.style.left = '50%';
            confirmationDiv.style.top = '50%';
            confirmationDiv.style.transform = 'translate(-50%, -50%)';
            confirmationDiv.style.zIndex = 9999;
            document.body.appendChild(confirmationDiv);

            // Use html2canvas to capture the element
            html2canvas(confirmationDiv, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: "#FFFFFF"
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Sadhana Booking Confirmation Slip.jpg';
                link.href = canvas.toDataURL('image/jpeg', 0.92);
                link.click();

                // Remove temporary element
                document.body.removeChild(confirmationDiv);
            }).catch(err => {
                console.error('html2canvas error:', err);
                if (confirmationDiv.parentNode) confirmationDiv.parentNode.removeChild(confirmationDiv);
            });
        }

        // Show success message
        function showSuccessMessage() {
            const successDiv = document.createElement('div');
            successDiv.className = 'status-message status-success';
            successDiv.innerHTML = `
                <h3 style="color: #506C4A; margin-bottom: 10px;">âœ“ Booking Successfully Submitted!</h3>
                <p>Your booking confirmation has been downloaded. We look forward to welcoming you to Sadhana Yoga Retreat!</p>
            `;

            // Insert after the booking form
            const bookingForm = document.getElementById('bookingForm');
            bookingForm.parentNode.insertBefore(successDiv, bookingForm.nextSibling);

            // Remove message after 5 seconds
            setTimeout(() => {
                successDiv.remove();
            }, 5000);
        }

        // Booking submission
        function initBookingForm() {
            document.getElementById("bookingForm").addEventListener("submit", async function (e) {
                e.preventDefault();
                const form = e.target;
                const bookingCode = Math.floor(1000000 + Math.random() * 9000000);

                const data = {
                    guest_name: form.guest_name.value,
                    country: form.country.value,
                    email: form.email.value,
                    phone: phoneHiddenInput.value,
                    package: form.package.value,
                    room_type: form.room_type.value,
                    price: priceInput.value,
                    arrival_date: arrivalInput.value,
                    departure_date: departureInput.value,
                    remarks: form.remarks.value,
                    booking_code: bookingCode,
                    timestamp: new Date().toISOString()
                };

                try {
                    // Show loading state
                    const submitBtn = form.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    submitBtn.textContent = "Submitting...";
                    submitBtn.disabled = true;

                    // --- FIXED: Send JSON as text/plain to avoid preflight OPTIONS ---
                    const response = await fetch(scriptURL, {
                        method: "POST",
                        headers: {
                            "Content-Type": "text/plain;charset=UTF-8"
                        },
                        body: JSON.stringify(data)
                    });

                    const responseText = await response.text();
                    console.log('Server response status:', response.status, responseText);

                    // Check if response is successful
                    if (response.ok) {
                        // Download confirmation as JPEG
                        downloadConfirmationAsImage(data);

                        // Show success message
                        showSuccessMessage();

                        // Reset form
                        form.reset();
                        roomSelect.innerHTML = "<option value='' disabled selected>Select Room Type</option>";
                        priceInput.value = "";
                        priceDisplay.textContent = "$0";

                        // Reload admin data if in admin view
                        if (!document.getElementById("adminPanel").classList.contains("hidden")) {
                            loadAdminData();
                        }
                    } else {
                        // Show server error text for easier debugging
                        throw new Error('Failed to submit booking. Server returned status ' + response.status + ': ' + responseText);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to submit booking. Check console for details.(' + (error.message || error) + ')');
                } finally {
                    // Reset button state
                    const submitBtn = form.querySelector('button[type="submit"]');
                    submitBtn.textContent = "Submit Booking";
                    submitBtn.disabled = false;
                }
            });
        }

        // Admin: fetch bookings
        async function loadAdminData() {
            try {
                const response = await fetch(scriptURL);
                const bookings = await response.json();

                // Check if bookings is an array
                if (Array.isArray(bookings)) {
                    updateDashboardCards(bookings);
                    renderTables(bookings);
                    setupSearchAndSort();
                } else {
                    console.error('Invalid data format received:', bookings);
                }
            } catch (error) {
                console.error('Error loading admin data:', error);
            }
        }

        // Update dashboard cards
        function updateDashboardCards(bookings) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Helper function to parse date from Google Sheets
            function parseSheetDate(dateStr) {
                if (!dateStr) return null;
                // Handle different date formats from Google Sheets
                const date = new Date(dateStr);
                return isNaN(date.getTime()) ? null : date;
            }

            // Arriving today
            const arrivingToday = bookings.filter(b => {
                const arrivalDate = parseSheetDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date ']);
                if (!arrivalDate) return false;
                arrivalDate.setHours(0, 0, 0, 0);
                return arrivalDate.getTime() === today.getTime();
            });

            // Departing today
            const departingToday = bookings.filter(b => {
                const departureDate = parseSheetDate(b['Departure Date'] || b['Departure date'] || b['Departure date ']);
                if (!departureDate) return false;
                departureDate.setHours(0, 0, 0, 0);
                return departureDate.getTime() === today.getTime();
            }).length;

            // Weekly bookings (next 7 days)
            const nextWeek = new Date(today);
            nextWeek.setDate(today.getDate() + 7);
            const weeklyBookings = bookings.filter(b => {
                const arrivalDate = parseSheetDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date ']);
                if (!arrivalDate) return false;
                return arrivalDate >= today && arrivalDate <= nextWeek;
            }).length;

            // Monthly estimate (completed bookings this month)
            const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            const monthlyEstimate = bookings
                .filter(b => {
                    const departureDate = parseSheetDate(b['Departure Date'] || b['Departure date'] || b['Departure date ']);
                    if (!departureDate) return false;
                    return departureDate >= firstDayOfMonth && departureDate <= today;
                })
                .reduce((total, b) => {
                    const priceStr = b['Price'] || b[' price'] || '0';
                    const price = parseFloat(priceStr.toString().replace("$", "")) || 0;
                    return total + price;
                }, 0);

            // Update dashboard cards
            document.getElementById("arrivingToday").textContent = arrivingToday.length;
            document.getElementById("departingToday").textContent = departingToday;
            document.getElementById("weeklyBookings").textContent = weeklyBookings;
            document.getElementById("monthlyEstimate").textContent = "$" + monthlyEstimate;

            // Render arriving today table
            const arrivingTodayTbody = document.querySelector("#arrivingTodayTable tbody");
            arrivingTodayTbody.innerHTML = "";

            arrivingToday.forEach(b => {
                const phoneRaw = b['Whatsapp/ Phone ( with country code )'] || b['WhatsApp / Phone'] || b['WhatsApp / Phone '] || b['WhatsApp / Phone'] || b['Phone'] || b['phone'] || b['WhatsApp'] || '';
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${b['Guest Name'] || b['Guest'] || ''}</td>
                    <td>${b['Retreat Package'] || b['Retreat Package '] || b['Retreat Package'] || ''}</td>
                    <td>${phoneRaw ? `<a class="whatsapp-link" href="${phoneRaw}" target="_blank" rel="noopener noreferrer">WhatsApp</a>` : ''}</td>
                    <td>${formatDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date '])}</td>
                    <td>${formatDate(b['Departure Date'] || b['Departure date'] || b['Departure date '])}</td>
                    <td>${b['Price'] || ''}</td>
                `;
                arrivingTodayTbody.appendChild(tr);
            });
        }

        function renderTables(bookings) {
            const now = new Date();

            // Helper function to parse date from Google Sheets
            function parseSheetDate(dateStr) {
                if (!dateStr) return new Date(0); // Return epoch for invalid dates
                const date = new Date(dateStr);
                return isNaN(date.getTime()) ? new Date(0) : date;
            }

            // Filter upcoming bookings (arrival date is in the future or today)
            const upcoming = bookings
                .filter(b => {
                    const arrivalDate = parseSheetDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date ']);
                    return arrivalDate >= now;
                })
                .sort((a, b) => {
                    const dateA = parseSheetDate(a['Arrival Date'] || a['Arrival date'] || a['Arrival date ']);
                    const dateB = parseSheetDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date ']);
                    return dateA - dateB;
                });

            // Render upcoming bookings table
            const upcomingTbody = document.querySelector("#upcomingTable tbody");
            upcomingTbody.innerHTML = "";

            upcoming.forEach(b => {
                const phoneRaw = b['Whatsapp/ Phone ( with country code )'] || b['WhatsApp / Phone'] || b['WhatsApp / Phone '] || b['WhatsApp / Phone'] || b['Phone'] || b['phone'] || b['WhatsApp'] || '';
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${b['Guest Name'] || ''}</td>
                    <td>${b['Retreat Package'] || b['Retreat Package '] || ''}</td>
                    <td>${phoneRaw ? `<a class="whatsapp-link" href="${phoneRaw}" target="_blank" rel="noopener noreferrer">WhatsApp</a>` : ''}</td>
                    <td>${formatDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date '])}</td>
                    <td>${formatDate(b['Departure Date'] || b['Departure date'] || b['Departure date '])}</td>
                    <td>${b['Price'] || ''}</td>
                `;
                upcomingTbody.appendChild(tr);
            });

            // Render all bookings table
            const allTbody = document.querySelector("#allBookingsTable tbody");
            allTbody.innerHTML = "";

            bookings.forEach(b => {
                const phoneRaw = b['Whatsapp/ Phone ( with country code )'] || b['WhatsApp / Phone'] || b['WhatsApp / Phone '] || b['WhatsApp / Phone'] || b['Phone'] || b['phone'] || b['WhatsApp'] || '';
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${b['Guest Name'] || ''}</td>
                    <td>${b['Retreat Package'] || b['Retreat Package '] || ''}</td>
                    <td>${phoneRaw ? `<a class="whatsapp-link" href="${phoneRaw}" target="_blank" rel="noopener noreferrer">WhatsApp</a>` : ''}</td>
                    <td>${formatDate(b['Arrival Date'] || b['Arrival date'] || b['Arrival date '])}</td>
                    <td>${formatDate(b['Departure Date'] || b['Departure date'] || b['Departure date '])}</td>
                    <td>${b['Price'] || ''}</td>
                `;
                allTbody.appendChild(tr);
            });
        }

        // Search and sort functionality
        function setupSearchAndSort() {
            // Search functionality
            const upcomingSearch = document.getElementById("upcomingSearch");
            const allBookingsSearch = document.getElementById("allBookingsSearch");

            upcomingSearch.addEventListener("input", () => {
                filterTable("upcomingTable", upcomingSearch.value);
            });

            allBookingsSearch.addEventListener("input", () => {
                filterTable("allBookingsTable", allBookingsSearch.value);
            });

            // Clear search buttons
            document.getElementById("clearUpcomingSearch").addEventListener("click", () => {
                upcomingSearch.value = "";
                filterTable("upcomingTable", "");
            });

            document.getElementById("clearAllSearch").addEventListener("click", () => {
                allBookingsSearch.value = "";
                filterTable("allBookingsTable", "");
            });

            // Sort functionality
            document.querySelectorAll("th[data-sort]").forEach(th => {
                th.addEventListener("click", () => {
                    const tableId = th.closest("table").id;
                    const sortKey = th.getAttribute("data-sort");
                    sortTable(tableId, sortKey);
                });
            });
        }

        function filterTable(tableId, searchTerm) {
            const table = document.getElementById(tableId);
            const rows = table.querySelectorAll("tbody tr");

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm.toLowerCase()) ? "" : "none";
            });
        }

        function sortTable(tableId, sortKey) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector("tbody");
            const rows = Array.from(tbody.querySelectorAll("tr"));

            // Map field names from table headers to data keys
            const fieldMap = {
                "guest_name": 0,
                "package": 1,
                "whatsapp": 2,
                "arrival_date": 3,
                "departure_date": 4,
                "price": 5
            };

            const columnIndex = fieldMap[sortKey];

            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent;
                const bValue = b.cells[columnIndex].textContent;

                // Handle dates
                if (sortKey.includes("date")) {
                    return new Date(aValue) - new Date(bValue);
                }

                // Handle prices
                if (sortKey === "price") {
                    const aNum = parseFloat(aValue.replace("$", "")) || 0;
                    const bNum = parseFloat(bValue.replace("$", "")) || 0;
                    return aNum - bNum;
                }

                // Default string comparison
                return aValue.localeCompare(bValue);
            });

            // Clear and re-append sorted rows
            tbody.innerHTML = "";
            rows.forEach(row => tbody.appendChild(row));
        }

        // Initialize the application
        function initApp() {
            initForm();
            initAdminLogin();
            initBookingForm();

            // Set minimum date for arrival to today
            const today = new Date().toISOString().split('T')[0];
            arrivalInput.min = today;
        }

        // Start the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>